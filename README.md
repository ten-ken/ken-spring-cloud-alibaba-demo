# ã€Spring-Cloud-Alibaba-Wikiã€

è‡´åŠ›æ„å»ºä¸€ä¸ªçš„ Java å¾®æœåŠ¡ä½“ç³»çš„çŸ¥è¯†.

è§†é¢‘åœ°å€: https://www.bilibili.com/video/BV1Qe411g7b5

## å…³äº

ğŸ“ ä¸‰éåšä¸»ï¼ˆéå¤§å‚ã€é985ã€211ï¼‰ 

ğŸ“– æ–‡ç« åœ°å€ï¼š

â€‹	1.[https://blog.csdn.net/jikuicui7402/article/details/126688014](https://blog.csdn.net/jikuicui7402/article/details/126688014)

â€‹	2.[https://juejin.cn/post/7139703269596594206](https://juejin.cn/post/7139703269596594206)

ğŸ **å­¦ä¹ äº¤æµç¾¤**ï¼š
![ç¼–ç¨‹äº¤æµç¾¤](ken-springcloud-alibaba-api/src/%E7%BC%96%E7%A8%8B%E4%BA%A4%E6%B5%81%E7%BE%A4-01.jpg)

ğŸ **æ–‡æ¡£åœ°å€**ï¼š 1.[ **csdn** ](https://blog.csdn.net/jikuicui7402)
                   2. **å…¬ä¼—å·** ï¼šç¨‹åºå‘˜ken

ğŸ˜‰ æœ‰ä»€ä¹ˆé—®é¢˜ä¹Ÿå¯ä»¥æ·»åŠ æˆ‘çš„å¾®ä¿¡(quyang134)ï¼Œè®°å¾—å¤‡æ³¨æ¥æ„ï¼šæ ¼å¼ ï¼ˆåŸå¸‚- æ˜µç§° - æ¥æ„ï¼‰

## å‹˜è¯¯

ç”±äºæœ¬äººæ°´å¹³æœ‰é™ï¼Œä»“åº“ä¸­çš„çŸ¥è¯†ç‚¹æ¥è‡ªæœ¬äººåŸåˆ›ï¼Œå¦‚æœä½ åœ¨é˜…è¯»æœ¬ä»“åº“è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä½ å‘ç°å›¾ç¤ºã€ä»£ç ä¸­çš„é”™è¯¯ï¼Œå¯ä»¥æäº¤ Issue  çš„æ–¹å¼è¿›è¡Œé—®é¢˜åé¦ˆï¼Œå¸®åŠ©Kenå®Œå–„è¿™ä¸ªä»“åº“~

- Issueï¼š[https://gitee.com/ten-ken/ken-spring-cloud-alibaba/issues/new](https://gitee.com/ten-ken/ken-spring-cloud-alibaba/issues/new)

![issue](https://gitee.com/ten-ken/image11/raw/master/relate_img/issue%E5%9B%BE%E6%A0%87.png)



## ä»£ç ç»“æ„



**-----çˆ¶é¡¹ç›®**   

$---å­é¡¹ç›®ï¼ˆken-springcloud-alibaba-apiã€å­˜æ”¾å®ä½“ï¼Œä¾¿äºå…¶ä»–é¡¹ç›®å¯ä»¥è®¿é—®ã€‘ï¼‰$

$---å­é¡¹ç›® ï¼ˆnacos-configã€nacosä½œä¸ºé…ç½®ä¸­å¿ƒã€‘ï¼‰$

$---å­é¡¹ç›® ï¼ˆnacos-provider-01ã€æœåŠ¡æä¾›æ–¹ã€‘ä¹Ÿå……å½“äº† seataæ¡ˆä¾‹ä¸­ ç”¨æˆ·æœåŠ¡ï¼‰$

$---å­é¡¹ç›®   ï¼ˆnacos-consumerã€æœåŠ¡æ¶ˆè´¹æ–¹ã€‘ï¼‰$

$---å­é¡¹ç›®   ï¼ˆsentinel-core ç†”æ–­é™çº§/æœåŠ¡çº¿è·¯ï¼‰$

$---å­é¡¹ç›®     (sentinel-feign  æ•´åˆfeign,æ¥å£å¼è°ƒç”¨api)$

$---å­é¡¹ç›®     (sentinel-zuul  æ•´åˆzuul,ä½¿ç”¨è·¯ç”±ç½‘å…³è®¿é—®æœåŠ¡)$

$---å­é¡¹ç›®     (sentinel-gateway æ•´åˆgateway ,ä½¿ç”¨è·¯ç”±ç½‘å…³è®¿é—®æœåŠ¡)$

$---å­é¡¹ç›®     (test-rocketmq   æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè®¢é˜…è€…å’Œç”Ÿäº§è€…éƒ½åœ¨é¡¹ç›®é‡Œé¢)$

$--- å­é¡¹ç›®       (seata-order-service  seata-æ¡ˆä¾‹ ---è®¢å•æœåŠ¡)$

$--- å­é¡¹ç›®       (seata-storage-service  seata-æ¡ˆä¾‹ ---åº“å­˜æœåŠ¡)$

$--- å­é¡¹ç›®       (seata-account-service  seata-æ¡ˆä¾‹ ---seataè°ƒç”¨å…¶ä»–æœåŠ¡ å®ç°äº‹åŠ¡å›æ»š)$

$--- å­é¡¹ç›®       (seata-business-service  seata-æ¡ˆä¾‹ ---seataè°ƒç”¨å…¶ä»–æœåŠ¡ å®ç°äº‹åŠ¡å›æ»š)$


## å…³äºä¸­é—´ä»¶çš„å¯åŠ¨

### Nacos

å¯åŠ¨å‘½ä»¤ï¼š

> startup.cmd -m standalone

[^ç‰ˆæœ¬]: è¿™è¾¹ä½¿ç”¨çš„nacoså®¢æˆ·ç«¯ç‰ˆæœ¬ä¸º2.0.3

### Sentinel

å¯åŠ¨å‘½ä»¤ï¼š

> java -Dserver.port=ã€portã€‘-Dcsp.sentinel.dashboard.server=ã€ip:portã€‘ -Dproject.name=sentinel-dashboard -jar sentinel-dashboard.jar

[^ç‰ˆæœ¬]: è¿™è¾¹ä½¿ç”¨çš„Sentinelå®¢æˆ·ç«¯ç‰ˆæœ¬ä¸º,ã€ã€‘è¿™æ ·çš„åœ°æ–¹æ”¹æˆä½ è‡ªå·±ç«¯å£å’Œip

### RocketMQ

ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨namesrv

> start mqnamesrv.cmd

ç¬¬äºŒæ­¥ï¼šå¯åŠ¨broker

> start mqbroker.cmd -n 127.0.0.1:9876 -c ../conf/broker.conf autoCreateTopicEnable=true

[^ç‰ˆæœ¬]: è¿™è¾¹ä½¿ç”¨çš„RocketMQå®¢æˆ·ç«¯ç‰ˆæœ¬ä¸º4.3.2

é…ç½®æ–‡ä»¶(broker.conf)ä¿¡æ¯:

```
#æ£€æµ‹ç‰©ç†æ–‡ä»¶ç£ç›˜ç©ºé—´
diskMaxUsedSpaceRatio=88
#å­˜å‚¨è·¯å¾„
storePathRootDir=E:/dev-soft/rocketmq-all-4.3.2-bin-release/store
#commitLogå­˜å‚¨è·¯å¾„
storePathCommitLog=E:/dev-soft/rocketmq-all-4.3.2-bin-release/store/commitlog
#æ¶ˆè´¹é˜Ÿåˆ—å­˜å‚¨è·¯å¾„
storePathConsumeQueue=E:/dev-soft/rocketmq-all-4.3.2-bin-release/store/consumequeue
#æ¶ˆæ¯ç´¢å¼•å­˜å‚¨è·¯å¾„
storePathIndex=E:/dev-soft/rocketmq-all-4.3.2-bin-release/store/index
#checkpoint æ–‡ä»¶å­˜å‚¨è·¯å¾„
storeCheckpoint=E:/dev-soft/rocketmq-all-4.3.2-bin-release/store/checkpoint
#abort æ–‡ä»¶å­˜å‚¨è·¯å¾„
abortFile=E:/dev-soft/rocketmq-all-4.3.2-bin-release/store/abort
```

[^å…³äºé…ç½®]: ç›¸åº”çš„åœ°å€éœ€è¦æ”¹æˆä½ æœ¬åœ°å­˜åœ¨æ–‡ä»¶åœ°å€

### Seata

å¯åŠ¨å‘½ä»¤ï¼š

> start seata-server.bat -p 8091 -m file

[^ç‰ˆæœ¬]: è¿™è¾¹ä½¿ç”¨çš„seataå®¢æˆ·ç«¯ç‰ˆæœ¬ä¸º1.4.1

## ä¸­é—´ä»¶çš„ä½¿ç”¨


### 1.Nacos
![nacos](https://gitee.com/ten-ken/ken-spring-cloud-alibaba-demo/raw/master/images/Nacos.png)

#### 1.1ä»€ä¹ˆæ˜¯ Nacos

â€‹	Nacos è‡´åŠ›äºå¸®åŠ©æ‚¨å‘ç°ã€é…ç½®å’Œç®¡ç†å¾®æœåŠ¡ã€‚Nacos æä¾›äº†ä¸€ç»„ç®€å•æ˜“ç”¨çš„ç‰¹æ€§é›†ï¼Œå¸®åŠ©æ‚¨å¿«é€Ÿå®ç°åŠ¨æ€æœåŠ¡å‘ç°ã€æœåŠ¡é…ç½®ã€æœåŠ¡å…ƒæ•°æ®åŠæµé‡ç®¡ç†ã€‚



#### 1.2  å…³è”ï¼ˆæ¨¡å—ï¼‰é¡¹ç›®

- æ¨¡å—ï¼š$nacos-config$

- ä½œç”¨ï¼šå®ç°äº†nacosé…ç½®ä¸­å¿ƒçš„ä½œç”¨

- æ ¸å¿ƒä¾èµ–:

```
    <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>
        </dependency>
```

- æ¨¡å—ï¼š$nacos-provider-01$

- ä½œç”¨ï¼šä½œä¸ºæœåŠ¡æä¾›æ–¹

- æ ¸å¿ƒä¾èµ–:

```
    <!--æœåŠ¡æ³¨å†Œä¸å‘ç°-->
        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
        </dependency>
```

- æ¨¡å—ï¼š$nacos-consumer$

- ä½œç”¨ï¼šä½œä¸ºæœåŠ¡æ¶ˆè´¹æ–¹

- æ ¸å¿ƒä¾èµ–:

```
    <!--æœåŠ¡æ³¨å†Œä¸å‘ç°-->
       <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
        </dependency>
```




### 2.Sentinel

![1657787936648](https://gitee.com/ten-ken/ken-spring-cloud-alibaba-demo/raw/master/images/Sentinel.png)

#### 2.1ä»€ä¹ˆæ˜¯ Sentinel

â€‹	éšç€å¾®æœåŠ¡çš„æµè¡Œï¼ŒæœåŠ¡å’ŒæœåŠ¡ä¹‹é—´çš„ç¨³å®šæ€§å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚[Sentinel](https://sentinelguard.io/)Â ä»¥æµé‡ä¸ºåˆ‡å…¥ç‚¹ï¼Œä»æµé‡æ§åˆ¶ã€æµé‡è·¯ç”±ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè‡ªé€‚åº”è¿‡è½½ä¿æŠ¤ã€çƒ­ç‚¹æµé‡é˜²æŠ¤ç­‰å¤šä¸ªç»´åº¦ä¿æŠ¤æœåŠ¡çš„ç¨³å®šæ€§ã€‚ 



#### 2.2  å…³è”ï¼ˆæ¨¡å—ï¼‰é¡¹ç›®

- æ¨¡å—ï¼š$sentinel-core$

- ä½œç”¨ï¼šå®ç°äº†sentinel çš„æœåŠ¡ç†”æ–­ï¼ˆé™çº§ï¼‰ã€æœåŠ¡é™æµ ä»¥åŠåŠ¨æ€é…ç½®é™æµè§„åˆ™

- æ ¸å¿ƒä¾èµ–:

```
          <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-sentinel</artifactId>
        </dependency>
        <!-- #æ³¨æ„æ•°æ®æºçš„ä¾èµ–è¦å•ç‹¬å¼•å…¥ï¼ˆæ¯”å¦‚ sentinel-datasource-nacos)-->
        <dependency>
            <groupId>com.alibaba.csp</groupId>
            <artifactId>sentinel-datasource-nacos</artifactId>
        </dependency>
```

- æ¨¡å—ï¼š$sentinel-feign$

- ä½œç”¨ï¼šå®ç°Feignæ¥å£å¼è®¿é—®æœåŠ¡

- æ ¸å¿ƒä¾èµ–:

```
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-openfeign</artifactId>
        </dependency>

        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-sentinel</artifactId>
        </dependency>
```

- æ¨¡å—ï¼š$sentinel-zuul$

- ä½œç”¨ï¼šå®ç°äº†è·¯ç”±ç½‘å…³è®¿é—®æœåŠ¡

- æ ¸å¿ƒä¾èµ–:

```
         <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-sentinel</artifactId>
        </dependency>

        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-alibaba-sentinel-gateway</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-netflix-zuul</artifactId>
        </dependency>
```

- æ¨¡å—ï¼š$sentinel-gateway$

- ä½œç”¨ï¼šå®ç°äº†è·¯ç”±ç½‘å…³è®¿é—®æœåŠ¡

- æ ¸å¿ƒä¾èµ–:

```
     <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-sentinel</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-gateway</artifactId>
        </dependency>

        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-alibaba-sentinel-gateway</artifactId>
        </dependency>
```



### 3.RocketMQ

![1657787936648](https://gitee.com/ten-ken/ken-spring-cloud-alibaba-demo/raw/master/images/RocketMQ.png)

#### 3.1ä»€ä¹ˆæ˜¯ RocketMQ

â€‹	æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­é‡è¦çš„ç»„ä»¶ï¼Œä¸»è¦è§£å†³åº”ç”¨è§£è€¦ï¼Œå¼‚æ­¥æ¶ˆæ¯ï¼Œæµé‡å‰Šé”‹ç­‰é—®é¢˜ï¼Œå®ç°é«˜æ€§èƒ½ï¼Œé«˜å¯ç”¨ï¼Œå¯ä¼¸ç¼©å’Œæœ€ç»ˆä¸€è‡´æ€§æ¶æ„ã€‚æœ¬æ¡ˆä¾‹ä¸­ä½¿ç”¨çš„æ¶ˆæ¯ä¸­é—´ä»¶ä¸ºRocketMQ ã€‚

#### 3.2  å…³è”ï¼ˆæ¨¡å—ï¼‰é¡¹ç›®

- æ¨¡å—ï¼š$test-rocketmq$

- ä½œç”¨ï¼šå®ç°äº†æ¶ˆæ¯å‘å¸ƒä¸æ¶ˆæ¯æ¥æ”¶ã€ä½¿ç”¨tagsè¿›è¡Œæ¶ˆæ¯è¿‡æ»¤ä»¥åŠä½¿ç”¨æ¶ˆæ¯äº‹åŠ¡ç­‰

- æ ¸å¿ƒä¾èµ–:

```
         <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-stream-rocketmq</artifactId>
        </dependency>
```



### 4.Seata

![1657787936648](https://gitee.com/ten-ken/ken-spring-cloud-alibaba-demo/raw/master/images/Seata.png)

#### 4.1ä»€ä¹ˆæ˜¯ Seata

â€‹	**ç”¨äºå¾®æœåŠ¡**æ¶æ„çš„å…·æœ‰é«˜æ€§èƒ½å’Œæ˜“ç”¨æ€§çš„åˆ†å¸ƒå¼**äº‹åŠ¡è§£å†³æ–¹æ¡ˆ**ã€‚

#### 4.2  å…³è”ï¼ˆæ¨¡å—ï¼‰é¡¹ç›®

- æ¨¡å—ï¼š$nacos-provider-order-service$

- ä½œç”¨ï¼šä½œä¸ºåˆ†å¸ƒå¼äº‹åŠ¡çš„åˆ†æ”¯ï¼ˆbranch)ã€å…¶å®ä¹Ÿæ˜¯è®¢å•æœåŠ¡çš„æä¾›è€…
- ç±»ä¼¼çš„æ¨¡å—ï¼š$nacos-provider-storage-service$ (åº“å­˜æœåŠ¡)   ã€$nacos-provider-01$ (ç”¨æˆ·æœåŠ¡) 

- æ ¸å¿ƒä¾èµ–:

```
         <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>
        <!--æœåŠ¡æ³¨å†Œ-->
        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
        </dependency>
        
        <!--å¢åŠ åˆ†å¸ƒå¼äº‹åŠ¡ seata-->
        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-seata</artifactId>
        </dependency>
```



- æ¨¡å—ï¼š$nacos-consumer-business-service$

- ä½œç”¨ï¼šä½œä¸ºåˆ†å¸ƒå¼äº‹åŠ¡çš„ä¸»è¦æ¶ˆè´¹è€…ï¼Œç›®çš„æ˜¯éªŒè¯äº‹åŠ¡å¯å›æ»š

- æ ¸å¿ƒä¾èµ–:

```
        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-seata</artifactId>
        </dependency>
        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
        </dependency>
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-openfeign</artifactId>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>
        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-starter-alibaba-sentinel</artifactId>
        </dependency>
```

[^æ³¨æ„]: è¿™è¾¹ä½¿ç”¨äº†feignè¿›è¡ŒæœåŠ¡è°ƒç”¨
